{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "chat",
  "type": "registry:component",
  "title": "Chat",
  "description": "Complete chat interface component with messages, input, avatars, timestamps, and real-time features",
  "dependencies": [
    "class-variance-authority",
    "clsx",
    "tailwind-merge"
  ],
  "registryDependencies": [
    "button",
    "input",
    "nocta-icons"
  ],
  "files": [
    {
      "path": "registry/ui/chat.tsx",
      "content": "'use client';\n\nimport { cva, type VariantProps } from 'class-variance-authority';\nimport type React from 'react';\nimport { useCallback, useEffect, useRef, useState } from 'react';\nimport { cn } from '@/lib/utils';\nimport { Button } from '@/registry/ui/button';\nimport { Icons } from '@/registry/ui/nocta-icons';\nimport { Textarea } from '@/registry/ui/textarea';\n\nconst chatVariants = cva(\n\t'relative border rounded-lg shadow-md card-highlight not-prose',\n\t{\n\t\tvariants: {\n\t\t\tvariant: {\n\t\t\t\tdefault: 'bg-card border-border',\n\t\t\t},\n\t\t},\n\t\tdefaultVariants: {\n\t\t\tvariant: 'default',\n\t\t},\n\t},\n);\n\nconst messageVariants = cva(\n\t[\n\t\t'w-fit max-w-[80%] rounded-lg px-3 py-2 text-sm',\n\t\t'not-prose',\n\t\t'overflow-hidden',\n\t],\n\t{\n\t\tvariants: {\n\t\t\tvariant: {\n\t\t\t\tuser: 'bg-foreground/90 text-card',\n\t\t\t\tassistant: 'bg-card-muted text-foreground',\n\t\t\t\tsystem: 'mx-auto bg-card-muted text-center text-xs text-foreground/70',\n\t\t\t},\n\t\t},\n\t\tdefaultVariants: {\n\t\t\tvariant: 'user',\n\t\t},\n\t},\n);\n\nexport interface ChatMessage {\n\tid: string;\n\tcontent: string;\n\tsender: 'user' | 'assistant' | 'system';\n\ttimestamp: Date;\n\tavatar?: string;\n\tname?: string;\n}\n\nexport interface TypingUser {\n\tid: string;\n\tname?: string;\n\tavatar?: string;\n}\n\nexport interface ChatProps\n\textends React.HTMLAttributes<HTMLDivElement>,\n\t\tVariantProps<typeof chatVariants> {\n\tmessages?: ChatMessage[];\n\tonSendMessage?: (message: string) => void;\n\tplaceholder?: string;\n\tdisabled?: boolean;\n\tautoFocus?: boolean;\n\tmaxLength?: number;\n\tshowTimestamps?: boolean;\n\tshowAvatars?: boolean;\n\tallowMultiline?: boolean;\n\ttypingUsers?: TypingUser[];\n\tclassName?: string;\n}\n\nexport interface ChatMessagesProps\n\textends React.HTMLAttributes<HTMLDivElement> {\n\tmessages: ChatMessage[];\n\tshowTimestamps?: boolean;\n\tshowAvatars?: boolean;\n\ttypingUsers?: TypingUser[];\n\tclassName?: string;\n}\n\nexport interface ChatMessageProps extends React.HTMLAttributes<HTMLDivElement> {\n\tmessage: ChatMessage;\n\tshowTimestamp?: boolean;\n\tshowAvatar?: boolean;\n\tclassName?: string;\n}\n\nexport interface TypingIndicatorProps\n\textends React.HTMLAttributes<HTMLDivElement> {\n\ttypingUsers?: TypingUser[];\n\tshowAvatars?: boolean;\n\tclassName?: string;\n}\n\nexport interface ChatInputProps extends React.HTMLAttributes<HTMLDivElement> {\n\tonSendMessage: (message: string) => void;\n\tplaceholder?: string;\n\tdisabled?: boolean;\n\tautoFocus?: boolean;\n\tmaxLength?: number;\n\tallowMultiline?: boolean;\n\tclassName?: string;\n}\n\nexport interface ChatActionsProps extends React.HTMLAttributes<HTMLDivElement> {\n\tchildren: React.ReactNode;\n\tclassName?: string;\n}\n\nexport const TypingIndicator: React.FC<TypingIndicatorProps> = ({\n\ttypingUsers,\n\tshowAvatars = false,\n\tclassName = '',\n\t...props\n}) => {\n\tconst safeTypingUsers = typingUsers ?? [];\n\tif (safeTypingUsers.length === 0) return null;\n\n\tconst getTypingText = () => {\n\t\tconst [firstUser, secondUser] = safeTypingUsers;\n\t\tif (safeTypingUsers.length === 1) {\n\t\t\treturn `${firstUser?.name || 'Someone'} is typing`;\n\t\t} else if (safeTypingUsers.length === 2) {\n\t\t\treturn `${firstUser?.name || 'Someone'} and ${secondUser?.name || 'someone else'} are typing`;\n\t\t} else {\n\t\t\treturn `${firstUser?.name || 'Someone'} and ${\n\t\t\t\tsafeTypingUsers.length - 1\n\t\t\t} others are typing`;\n\t\t}\n\t};\n\treturn (\n\t\t/* biome-ignore lint/a11y/useSemanticElements: typing indicator intentionally uses a div with role=\"status\" for accessibility */\n\t\t<div\n\t\t\trole=\"status\"\n\t\t\tclassName={cn('flex items-end gap-2', className)}\n\t\t\t{...props}\n\t\t>\n\t\t\t{showAvatars && (\n\t\t\t\t<div className=\"flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-card-muted text-xs font-medium text-foreground/70\">\n\t\t\t\t\t{safeTypingUsers[0]?.avatar ? (\n\t\t\t\t\t\t/* biome-ignore lint/performance/noImgElement: prefer native img here */\n\t\t\t\t\t\t<img\n\t\t\t\t\t\t\tsrc={safeTypingUsers[0]?.avatar}\n\t\t\t\t\t\t\talt={safeTypingUsers[0]?.name || 'typing'}\n\t\t\t\t\t\t\tclassName=\"h-full w-full rounded-full object-cover\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t{safeTypingUsers[0]?.name\n\t\t\t\t\t\t\t\t? safeTypingUsers[0]?.name.charAt(0).toUpperCase()\n\t\t\t\t\t\t\t\t: '?'}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t)}\n\n\t\t\t<div className=\"flex w-full flex-col items-start gap-1\">\n\t\t\t\t<div className=\"w-fit max-w-[80%] rounded-lg bg-card-muted px-3 py-2 text-sm text-foreground\">\n\t\t\t\t\t<div className=\"flex items-center gap-2\">\n\t\t\t\t\t\t<span className=\"text-xs text-foreground/70\">\n\t\t\t\t\t\t\t{getTypingText()}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<div className=\"flex gap-1\">\n\t\t\t\t\t\t\t<div className=\"h-1.5 w-1.5 animate-bounce rounded-full bg-foreground/60 [animation-delay:-0.3s]\" />\n\t\t\t\t\t\t\t<div className=\"h-1.5 w-1.5 animate-bounce rounded-full bg-foreground/60 [animation-delay:-0.15s]\" />\n\t\t\t\t\t\t\t<div className=\"h-1.5 w-1.5 animate-bounce rounded-full bg-foreground/60\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nexport const Chat: React.FC<ChatProps> = ({\n\tmessages = [],\n\tonSendMessage,\n\tplaceholder = 'Type a message...',\n\tdisabled = false,\n\tautoFocus = false,\n\tmaxLength = 500,\n\tshowTimestamps = false,\n\tshowAvatars = false,\n\tallowMultiline = true,\n\ttypingUsers = [],\n\tvariant = 'default',\n\tclassName = '',\n\t...props\n}) => {\n\treturn (\n\t\t<div className={cn(chatVariants({ variant }), className)} {...props}>\n\t\t\t<div className=\"flex h-full flex-col rounded-lg\">\n\t\t\t\t<ChatMessages\n\t\t\t\t\tmessages={messages}\n\t\t\t\t\tshowTimestamps={showTimestamps}\n\t\t\t\t\tshowAvatars={showAvatars}\n\t\t\t\t\ttypingUsers={typingUsers}\n\t\t\t\t\tclassName=\"max-h-96 min-h-0 flex-1\"\n\t\t\t\t/>\n\t\t\t\t{onSendMessage && (\n\t\t\t\t\t<ChatInput\n\t\t\t\t\t\tonSendMessage={onSendMessage}\n\t\t\t\t\t\tplaceholder={placeholder}\n\t\t\t\t\t\tdisabled={disabled}\n\t\t\t\t\t\tautoFocus={autoFocus}\n\t\t\t\t\t\tmaxLength={maxLength}\n\t\t\t\t\t\tallowMultiline={allowMultiline}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nexport const ChatMessages: React.FC<ChatMessagesProps> = ({\n\tmessages,\n\tshowTimestamps = false,\n\tshowAvatars = false,\n\ttypingUsers = [],\n\tclassName = '',\n\t...props\n}) => {\n\tconst messagesEndRef = useRef<HTMLDivElement>(null);\n\tconst containerRef = useRef<HTMLDivElement>(null);\n\n\t/* biome-ignore lint/correctness/useExhaustiveDependencies: scroll depends on message content changes */\n\tuseEffect(() => {\n\t\tif (containerRef.current && messagesEndRef.current) {\n\t\t\tconst container = containerRef.current;\n\t\t\tconst scrollHeight = container.scrollHeight;\n\t\t\tconst height = container.clientHeight;\n\t\t\tconst maxScrollTop = scrollHeight - height;\n\n\t\t\tcontainer.scrollTo({\n\t\t\t\ttop: maxScrollTop > 0 ? maxScrollTop : 0,\n\t\t\t\tbehavior: 'smooth',\n\t\t\t});\n\t\t}\n\t}, [messages.length, typingUsers.length]);\n\n\treturn (\n\t\t<div\n\t\t\tref={containerRef}\n\t\t\trole=\"log\"\n\t\t\taria-live=\"polite\"\n\t\t\taria-relevant=\"additions text\"\n\t\t\taria-label=\"Chat messages\"\n\t\t\tclassName={cn('flex-1 space-y-3 overflow-y-auto p-4', className)}\n\t\t\t{...props}\n\t\t>\n\t\t\t{messages.map((message) => (\n\t\t\t\t<ChatMessage\n\t\t\t\t\tkey={message.id}\n\t\t\t\t\tmessage={message}\n\t\t\t\t\tshowTimestamp={showTimestamps}\n\t\t\t\t\tshowAvatar={showAvatars}\n\t\t\t\t/>\n\t\t\t))}\n\t\t\t<TypingIndicator typingUsers={typingUsers} showAvatars={showAvatars} />\n\t\t\t<div ref={messagesEndRef} />\n\t\t</div>\n\t);\n};\n\nexport const ChatMessage: React.FC<ChatMessageProps> = ({\n\tmessage,\n\tshowTimestamp = false,\n\tshowAvatar = false,\n\tclassName = '',\n\t...props\n}) => {\n\tconst isUser = message.sender === 'user';\n\tconst isSystem = message.sender === 'system';\n\n\treturn (\n\t\t<div\n\t\t\trole={isSystem ? 'status' : 'listitem'}\n\t\t\tclassName={cn(\n\t\t\t\t'flex items-end gap-2',\n\t\t\t\tisUser ? 'flex-row-reverse' : 'flex-row',\n\t\t\t\tisSystem ? 'justify-center' : '',\n\t\t\t\tclassName,\n\t\t\t)}\n\t\t\t{...props}\n\t\t>\n\t\t\t{showAvatar && !isSystem && (\n\t\t\t\t<div className=\"flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-card-muted text-xs font-medium text-foreground/70\">\n\t\t\t\t\t{message.avatar ? (\n\t\t\t\t\t\t/* biome-ignore lint/performance/noImgElement: prefer native img here */\n\t\t\t\t\t\t<img\n\t\t\t\t\t\t\tsrc={message.avatar}\n\t\t\t\t\t\t\talt={message.name || message.sender}\n\t\t\t\t\t\t\tclassName=\"h-full w-full rounded-full object-cover\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t{message.name\n\t\t\t\t\t\t\t\t? message.name.charAt(0).toUpperCase()\n\t\t\t\t\t\t\t\t: message.sender.charAt(0).toUpperCase()}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t)}\n\n\t\t\t<div\n\t\t\t\tclassName={cn(\n\t\t\t\t\t'flex w-full flex-col gap-1',\n\t\t\t\t\tisUser ? 'items-end' : 'items-start',\n\t\t\t\t\tisSystem ? 'items-center' : '',\n\t\t\t\t)}\n\t\t\t>\n\t\t\t\t<div className={cn(messageVariants({ variant: message.sender }))}>\n\t\t\t\t\t<div className={cn('flex w-full flex-col gap-1')}>\n\t\t\t\t\t\t<div className=\"whitespace-pre-wrap\">{message.content}</div>\n\t\t\t\t\t\t{showTimestamp && (\n\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t'text-xs',\n\t\t\t\t\t\t\t\t\tisUser\n\t\t\t\t\t\t\t\t\t\t? 'text-right text-background/50'\n\t\t\t\t\t\t\t\t\t\t: 'text-left text-foreground/45',\n\t\t\t\t\t\t\t\t\tisSystem ? 'text-center' : '',\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{message.timestamp.toLocaleTimeString([], {\n\t\t\t\t\t\t\t\t\thour: '2-digit',\n\t\t\t\t\t\t\t\t\tminute: '2-digit',\n\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nexport const ChatInput: React.FC<ChatInputProps> = ({\n\tonSendMessage,\n\tplaceholder = 'Type a message...',\n\tdisabled = false,\n\tautoFocus = false,\n\tmaxLength = 500,\n\tallowMultiline = true,\n\tclassName = '',\n\t...props\n}) => {\n\tconst [message, setMessage] = useState('');\n\tconst textareaContainerRef = useRef<HTMLDivElement>(null);\n\n\tconst getTextareaElement = useCallback(() => {\n\t\treturn textareaContainerRef.current?.querySelector('textarea') ?? null;\n\t}, []);\n\n\tconst adjustTextareaHeight = useCallback(\n\t\t(element?: HTMLTextAreaElement | null) => {\n\t\t\tconst textarea = element ?? getTextareaElement();\n\t\t\tif (!textarea) return;\n\t\t\ttextarea.style.height = 'auto';\n\t\t\tconst newHeight = Math.min(textarea.scrollHeight, 120);\n\t\t\ttextarea.style.height = `${newHeight}px`;\n\t\t},\n\t\t[getTextareaElement],\n\t);\n\n\tuseEffect(() => {\n\t\tif (autoFocus) {\n\t\t\tgetTextareaElement()?.focus({ preventScroll: true });\n\t\t}\n\t}, [autoFocus, getTextareaElement]);\n\n\tconst handleSubmit = useCallback(\n\t\t(e: React.FormEvent) => {\n\t\t\te.preventDefault();\n\t\t\tif (message.trim() && !disabled) {\n\t\t\t\tonSendMessage(message.trim());\n\t\t\t\tsetMessage('');\n\t\t\t\tconst textarea = getTextareaElement();\n\t\t\t\tif (textarea) {\n\t\t\t\t\ttextarea.style.height = 'auto';\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t[message, disabled, onSendMessage, getTextareaElement],\n\t);\n\n\tconst handleKeyDown = useCallback(\n\t\t(e: React.KeyboardEvent) => {\n\t\t\tif (e.key === 'Enter') {\n\t\t\t\tif (allowMultiline && e.shiftKey) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\te.preventDefault();\n\t\t\t\thandleSubmit(e);\n\t\t\t}\n\t\t},\n\t\t[allowMultiline, handleSubmit],\n\t);\n\n\tconst handleTextareaChange = useCallback(\n\t\t(e: React.ChangeEvent<HTMLTextAreaElement>) => {\n\t\t\tconst value = e.target.value;\n\t\t\tif (maxLength && value.length > maxLength) return;\n\n\t\t\tsetMessage(value);\n\t\t\tadjustTextareaHeight(e.target);\n\t\t},\n\t\t[maxLength, adjustTextareaHeight],\n\t);\n\n\treturn (\n\t\t<div\n\t\t\tclassName={cn(\n\t\t\t\t'border-t border-border/60 bg-card-muted/30 p-4',\n\t\t\t\tclassName,\n\t\t\t)}\n\t\t\t{...props}\n\t\t>\n\t\t\t<form onSubmit={handleSubmit} className=\"flex items-center gap-2\">\n\t\t\t\t<div className=\"flex-1\" ref={textareaContainerRef}>\n\t\t\t\t\t<Textarea\n\t\t\t\t\t\tvalue={message}\n\t\t\t\t\t\tonChange={handleTextareaChange}\n\t\t\t\t\t\tonKeyDown={handleKeyDown}\n\t\t\t\t\t\tplaceholder={placeholder}\n\t\t\t\t\t\taria-label={placeholder || 'Type a message'}\n\t\t\t\t\t\taria-multiline={allowMultiline}\n\t\t\t\t\t\tdisabled={disabled}\n\t\t\t\t\t\trows={1}\n\t\t\t\t\t\tresize=\"none\"\n\t\t\t\t\t\tcontainerClassName=\"flex-1\"\n\t\t\t\t\t\twrapperClassName=\"h-full\"\n\t\t\t\t\t\tclassName=\"min-h-9\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<Button\n\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\tsize=\"md\"\n\t\t\t\t\taria-label=\"Send message\"\n\t\t\t\t\tdisabled={!message.trim() || disabled}\n\t\t\t\t>\n\t\t\t\t\t<Icons.SendMessage\n\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\tclassName=\"mb-0.5 ml-1 size-5 -rotate-45\"\n\t\t\t\t\t/>\n\t\t\t\t</Button>\n\t\t\t</form>\n\t\t\t{maxLength && (\n\t\t\t\t<div className=\"mt-1 text-right text-xs text-foreground/45 dark:text-foreground/45\">\n\t\t\t\t\t{message.length}/{maxLength}\n\t\t\t\t</div>\n\t\t\t)}\n\t\t</div>\n\t);\n};\n\nexport const ChatActions: React.FC<ChatActionsProps> = ({\n\tchildren,\n\tclassName = '',\n\t...props\n}) => {\n\treturn (\n\t\t<div className={cn('flex items-center gap-2', className)} {...props}>\n\t\t\t{children}\n\t\t</div>\n\t);\n};\n",
      "type": "registry:component"
    }
  ]
}