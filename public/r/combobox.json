{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "combobox",
  "type": "registry:component",
  "title": "Combobox",
  "description": "Searchable combobox component with filtering, keyboard navigation, and accessibility",
  "dependencies": [
    "@ariakit/react",
    "class-variance-authority",
    "clsx",
    "tailwind-merge"
  ],
  "registryDependencies": [
    "scroll-area",
    "nocta-icons"
  ],
  "files": [
    {
      "path": "registry/ui/combobox.tsx",
      "content": "'use client';\n\nimport * as Ariakit from '@ariakit/react';\nimport { cva, type VariantProps } from 'class-variance-authority';\nimport type React from 'react';\nimport {\n\tstartTransition,\n\tuseCallback,\n\tuseEffect,\n\tuseId,\n\tuseMemo,\n\tuseState,\n} from 'react';\nimport { cn } from '@/lib/utils';\nimport { Icons } from '@/registry/ui/nocta-icons';\nimport { ScrollArea } from '@/registry/ui/scroll-area';\n\nconst comboboxVariants = cva(\n\t`relative inline-flex w-fit cursor-pointer items-center justify-between bg-card text-foreground rounded-md border shadow-sm card-highlight hover:bg-card-muted transition-[background-color,color,box-shadow] ease-out-quad duration-100 focus-visible:ring-1 focus-visible:ring-offset-1 focus-visible:ring-offset-ring-offset/50 focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50`,\n\t{\n\t\tvariants: {\n\t\t\tvariant: {\n\t\t\t\tdefault: `border-border focus-visible:ring-ring/50`,\n\t\t\t\terror: `border-destructive/40 focus-visible:ring-destructive/50 dark:focus-visible:ring-destructive/50`,\n\t\t\t\tsuccess: `border-success/40 focus-visible:ring-success/50 dark:focus-visible:ring-success/50`,\n\t\t\t},\n\t\t\tsize: {\n\t\t\t\tsm: 'h-8 px-2.5 py-1.5 px-3 text-sm',\n\t\t\t\tmd: 'h-9 px-3 py-2 text-sm',\n\t\t\t\tlg: 'h-10 px-4 py-2 text-base',\n\t\t\t},\n\t\t},\n\t\tdefaultVariants: {\n\t\t\tvariant: 'default',\n\t\t\tsize: 'md',\n\t\t},\n\t},\n);\n\nexport interface ComboboxOption {\n\tvalue: string;\n\tlabel: string;\n\tdisabled?: boolean;\n}\n\nexport interface ComboboxProps extends VariantProps<typeof comboboxVariants> {\n\toptions: ComboboxOption[];\n\tvalue?: string;\n\tdefaultValue?: string;\n\tonValueChange?: (value: string) => void;\n\tportal?: boolean;\n\tplaceholder?: string;\n\tsearchPlaceholder?: string;\n\temptyMessage?: string;\n\tdisabled?: boolean;\n\tclassName?: string;\n\tpopoverClassName?: string;\n\tclearable?: boolean;\n}\n\nexport const Combobox: React.FC<ComboboxProps> = ({\n\toptions,\n\tvalue: controlledValue,\n\tdefaultValue,\n\tonValueChange,\n\tportal = true,\n\tplaceholder = 'Select option...',\n\tsearchPlaceholder = 'Search...',\n\temptyMessage = 'No options found',\n\tdisabled = false,\n\tsize = 'md',\n\tvariant = 'default',\n\tclassName = '',\n\tpopoverClassName = '',\n\tclearable = true,\n}) => {\n\tconst baseId = useId();\n\tconst [internalValue, setInternalValue] = useState(defaultValue ?? '');\n\tconst [searchValue, setSearchValue] = useState('');\n\n\tconst comboboxStore = Ariakit.useComboboxStore({\n\t\tresetValueOnHide: true,\n\t});\n\n\tconst selectStore = Ariakit.useSelectStore({\n\t\tvalue: controlledValue ?? internalValue,\n\t\t...(defaultValue !== undefined ? { defaultValue } : {}),\n\t\tanimated: true,\n\t\tcombobox: comboboxStore,\n\t\tsetValue: (value) => {\n\t\t\tconst nextValue = value == null ? '' : String(value);\n\t\t\tif (controlledValue === undefined) {\n\t\t\t\tsetInternalValue(nextValue);\n\t\t\t}\n\t\t\tif (onValueChange) {\n\t\t\t\tonValueChange(nextValue);\n\t\t\t}\n\t\t},\n\t});\n\n\tconst selectedValue = Ariakit.useStoreState(selectStore, (state) => {\n\t\tconst value = state.value;\n\t\tif (Array.isArray(value)) {\n\t\t\treturn String(value[value.length - 1] ?? '');\n\t\t}\n\t\treturn value == null ? '' : String(value);\n\t});\n\n\tconst selectedOption = useMemo(\n\t\t() => options.find((option) => option.value === selectedValue),\n\t\t[options, selectedValue],\n\t);\n\n\tconst matches = useMemo(() => {\n\t\tconst query = searchValue.trim().toLowerCase();\n\t\tif (!query) return options;\n\t\treturn options.filter((option) =>\n\t\t\toption.label.toLowerCase().includes(query),\n\t\t);\n\t}, [options, searchValue]);\n\n\tconst listId = `${baseId}-listbox`;\n\tconst isOpen = Ariakit.useStoreState(selectStore, (state) => state.open);\n\n\tuseEffect(() => {\n\t\tif (!isOpen) {\n\t\t\tcomboboxStore.setValue('');\n\t\t\tstartTransition(() => setSearchValue(''));\n\t\t}\n\t}, [comboboxStore, isOpen]);\n\n\tconst handleClear = useCallback(\n\t\t(event: React.SyntheticEvent) => {\n\t\t\tevent.stopPropagation();\n\t\t\tevent.preventDefault();\n\t\t\tselectStore.setValue('');\n\t\t\tcomboboxStore.setValue('');\n\t\t\tstartTransition(() => setSearchValue(''));\n\t\t},\n\t\t[comboboxStore, selectStore],\n\t);\n\n\treturn (\n\t\t<Ariakit.ComboboxProvider store={comboboxStore} resetValueOnHide>\n\t\t\t<Ariakit.SelectProvider store={selectStore}>\n\t\t\t\t<div className=\"relative\">\n\t\t\t\t\t<Ariakit.Select\n\t\t\t\t\t\tdisabled={disabled}\n\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\tcomboboxVariants({ variant, size }),\n\t\t\t\t\t\t\tdisabled && 'cursor-not-allowed opacity-50',\n\t\t\t\t\t\t\tclassName,\n\t\t\t\t\t\t)}\n\t\t\t\t\t>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t'flex-1 truncate text-left',\n\t\t\t\t\t\t\t\tselectedOption ? '' : 'text-foreground/45',\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{selectedOption ? selectedOption.label : placeholder}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<div className=\"ml-2 flex items-center gap-1\">\n\t\t\t\t\t\t\t{clearable && selectedOption && !disabled && (\n\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\tonMouseDown={handleClear}\n\t\t\t\t\t\t\t\t\tonClick={handleClear}\n\t\t\t\t\t\t\t\t\tonKeyDown={(e) => {\n\t\t\t\t\t\t\t\t\t\tif (e.key === 'Enter' || e.key === ' ') {\n\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\t\t\thandleClear(e);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\trole=\"button\"\n\t\t\t\t\t\t\t\t\ttabIndex={0}\n\t\t\t\t\t\t\t\t\tclassName=\"cursor-pointer rounded p-0.5 text-foreground/70 hover:text-foreground focus-visible:ring-1 focus-visible:ring-ring/50 focus-visible:ring-offset-1 focus-visible:ring-offset-ring-offset/50 focus-visible:outline-none\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<Icons.X aria-hidden=\"true\" className=\"h-3 w-3\" />\n\t\t\t\t\t\t\t\t\t<Ariakit.VisuallyHidden>\n\t\t\t\t\t\t\t\t\t\tClear Selection\n\t\t\t\t\t\t\t\t\t</Ariakit.VisuallyHidden>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t<Icons.CaretSort\n\t\t\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\t\t\tclassName=\"h-4.5 w-4.5 text-foreground/70\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</Ariakit.Select>\n\n\t\t\t\t\t<Ariakit.SelectPopover\n\t\t\t\t\t\tportal={portal}\n\t\t\t\t\t\tsameWidth\n\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t'absolute z-999 my-1 rounded-md border border-border bg-popover shadow-md card-highlight',\n\t\t\t\t\t\t\t'origin-top -translate-y-2 scale-95 opacity-0 transition-[scale,translate,opacity] duration-300 ease-smooth data-enter:translate-y-0 data-enter:scale-100 data-enter:opacity-100 data-leave:-translate-y-2 data-leave:scale-95 data-leave:opacity-0',\n\t\t\t\t\t\t\tpopoverClassName,\n\t\t\t\t\t\t)}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div className=\"border-b border-border/60 p-1 flex justify-start items-center\">\n\t\t\t\t\t\t\t<Icons.Search\n\t\t\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\t\t\tclassName=\"size-6 text-foreground/35 ml-2\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<Ariakit.Combobox\n\t\t\t\t\t\t\t\tautoSelect\n\t\t\t\t\t\t\t\tplaceholder={searchPlaceholder}\n\t\t\t\t\t\t\t\taria-controls={listId}\n\t\t\t\t\t\t\t\tonChange={(event) =>\n\t\t\t\t\t\t\t\t\tstartTransition(() =>\n\t\t\t\t\t\t\t\t\t\tsetSearchValue(event.currentTarget.value),\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tclassName=\"w-full border-0 bg-transparent pl-1.5 pr-2 py-1.5 text-sm placeholder:text-foreground/45 focus-visible:outline-none\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<ScrollArea\n\t\t\t\t\t\t\ttype=\"scroll\"\n\t\t\t\t\t\t\tclassName=\"z-50 flex flex-col h-full w-full max-h-42\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Ariakit.ComboboxList id={listId} className=\"flex flex-col py-1\">\n\t\t\t\t\t\t\t\t<div aria-live=\"polite\" className=\"sr-only\">\n\t\t\t\t\t\t\t\t\t{matches.length} result{matches.length === 1 ? '' : 's'}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t{matches.length === 0 ? (\n\t\t\t\t\t\t\t\t\t<output\n\t\t\t\t\t\t\t\t\t\taria-live=\"polite\"\n\t\t\t\t\t\t\t\t\t\tclassName=\"mx-1 px-2 py-1.5 text-center text-sm text-foreground/70\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{emptyMessage}\n\t\t\t\t\t\t\t\t\t</output>\n\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\tmatches.map((option) => {\n\t\t\t\t\t\t\t\t\t\tconst isSelected = option.value === selectedValue;\n\t\t\t\t\t\t\t\t\t\tconst itemDisabled = option.disabled === true;\n\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t<Ariakit.SelectItem\n\t\t\t\t\t\t\t\t\t\t\t\tkey={option.value}\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={option.value}\n\t\t\t\t\t\t\t\t\t\t\t\t{...(itemDisabled ? { disabled: true } : {})}\n\t\t\t\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\t\t\t'relative mx-1 flex cursor-pointer items-center justify-between rounded-sm px-2 py-1.5 text-sm text-foreground/70 select-none outline-none',\n\t\t\t\t\t\t\t\t\t\t\t\t\t'hover:bg-popover-muted hover:text-foreground data-active-item:bg-popover-muted data-active-item:text-foreground',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\"[&_svg]:shrink-0 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 gap-2\",\n\t\t\t\t\t\t\t\t\t\t\t\t\toption.disabled &&\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'pointer-events-none cursor-not-allowed opacity-50',\n\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\trender={\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Ariakit.ComboboxItem\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={option.label}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfocusOnHover\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetValueOnClick\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"flex-1\">{option.label}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t{isSelected && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Icons.Check\n\t\t\t\t\t\t\t\t\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"h-4 w-4 text-foreground/70\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t</Ariakit.SelectItem>\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</Ariakit.ComboboxList>\n\t\t\t\t\t\t</ScrollArea>\n\t\t\t\t\t</Ariakit.SelectPopover>\n\t\t\t\t</div>\n\t\t\t</Ariakit.SelectProvider>\n\t\t</Ariakit.ComboboxProvider>\n\t);\n};\n",
      "type": "registry:component"
    }
  ]
}